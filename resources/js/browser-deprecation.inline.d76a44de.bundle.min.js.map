{"version":3,"file":"browser-deprecation.inline.d76a44de.bundle.min.js","mappings":"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","sources":["webpack:///./browser-deprecation/browser-deprecation.ts","webpack:///../../thunderbolt-es5/dist/browser-deprecation.js","webpack:///../../thunderbolt-es5/dist/reportPhaseStarted.js"],"sourcesContent":["require('@wix/thunderbolt-es5')\n","\"use strict\";\nvar _a, _b, _c, _d;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar reportPhaseStarted_1 = require(\"./reportPhaseStarted\");\nvar version = 'v5';\nvar _window = window;\nvar userAgent = ((_c = (_b = (_a = _window.navigator) === null || _a === void 0 ? void 0 : _a.userAgent) === null || _b === void 0 ? void 0 : _b.toLowerCase) === null || _c === void 0 ? void 0 : _c.call(_b)) || '';\n// @ts-ignore Checking documentMode to detect IE\nvar isIEbyDocumentMode = !!((_d = _window.document) === null || _d === void 0 ? void 0 : _d.documentMode);\n// eslint-disable-next-line\nvar isIEByUA = !!(userAgent.match(/msie\\s([\\d.]+)/) || userAgent.match(/trident\\/[\\d](?=[^\\?]+).*rv:([0-9.].)/));\nvar isIE = isIEbyDocumentMode || isIEByUA;\nvar requiredBrowserNativeApis = ['customElements', 'IntersectionObserver', 'ResizeObserver'];\nvar supportsNativeBrowserApis = function () { return requiredBrowserNativeApis.every(function (api) { return api in window; }); };\nvar isSafari14InStudio = function () {\n    var _a, _b;\n    var isSafari14 = /605\\..*version\\/14\\.(?=.*safari)/i.test(userAgent);\n    var isWixStudio = ((_b = (_a = _window.viewerModel) === null || _a === void 0 ? void 0 : _a.site) === null || _b === void 0 ? void 0 : _b.editorName) === 'Studio';\n    return isSafari14 && isWixStudio;\n};\nvar isOldBrowser = !supportsCssVars() ||\n    !supportsCssGrid() ||\n    !supportsES2017() ||\n    !supportsNativeBrowserApis() ||\n    isSafari14InStudio();\nif (isIE || isOldBrowser) {\n    _window.__browser_deprecation__ = true; // Used to stop the JS flow in clientRunner\n    hideBody(); // Hide the HTML generated by SSR\n    muteSentry(); // Needs to happen synchronously as Sentry loader is embedded on VM\n    // Continue the flow (runDeprecationFlow) when DOM is ready\n    if (document.readyState === 'complete') {\n        runDeprecationFlow();\n    }\n    else {\n        document.addEventListener('readystatechange', function onReadyStateChange() {\n            if (document.readyState === 'complete') {\n                runDeprecationFlow();\n            }\n        });\n    }\n}\nfunction runDeprecationFlow() {\n    clearDomFromSSR();\n    showDeprecationMessage();\n    reportBI();\n}\nfunction hideBody() {\n    var head = document.head || document.getElementsByTagName('head')[0];\n    var style = document.createElement('style');\n    style.setAttribute('type', 'text/css');\n    style.appendChild(document.createTextNode('body { visibility: hidden; }'));\n    head.appendChild(style);\n}\nfunction clearDomFromSSR() {\n    var siteContainer = document.getElementById('SITE_CONTAINER');\n    siteContainer && (siteContainer.innerHTML = '');\n}\nfunction showDeprecationMessage() {\n    var iframe = document.createElement('iframe');\n    var iframeUrl = getIframeUrlForOldBrowserMessage();\n    iframe.setAttribute('src', iframeUrl);\n    iframe.setAttribute('style', 'position: fixed; top: 0; left: 0; width: 100%; height: 100%');\n    iframe.onload = function () {\n        document.body.style.visibility = 'visible';\n    };\n    document.body.appendChild(iframe);\n}\nfunction getIframeUrlForOldBrowserMessage() {\n    var _a;\n    var userLanguage = ((_a = _window.viewerModel) === null || _a === void 0 ? void 0 : _a.language.userLanguage) || 'en';\n    var supportedLanguages = { pt: 1, fr: 1, es: 1, de: 1, ja: 1 };\n    var messageLanguage = supportedLanguages[userLanguage] ? userLanguage : 'en';\n    return \"https://static.parastorage.com/services/wix-thunderbolt/dist/deprecation-\".concat(messageLanguage, \".\").concat(version, \".html\");\n}\nfunction reportBI() {\n    var supportedFeatures;\n    try {\n        supportedFeatures = {\n            customElements: 'customElements' in window,\n            IntersectionObserver: 'IntersectionObserver' in window,\n            ResizeObserver: 'ResizeObserver' in window,\n            supportsCssVars: supportsCssVars(),\n            supportsCssGrid: supportsCssGrid(),\n            supportsES2017: supportsES2017(),\n            isIE: isIE,\n        };\n    }\n    catch (e) {\n        console.error(e);\n        supportedFeatures = {};\n    }\n    (0, reportPhaseStarted_1.reportPhaseStarted)('browser_not_supported', \"supportedFeatures=\".concat(JSON.stringify(supportedFeatures)));\n}\nfunction muteSentry() {\n    _window.Sentry = { mute: true };\n}\nfunction supportsCssVars() {\n    var _a, _b;\n    var styleElement = document.createElement('style');\n    styleElement.innerHTML = ':root { --tmp-var: bold; }';\n    document.head.appendChild(styleElement);\n    var isSupported = !!(_window.CSS && _window.CSS.supports && _window.CSS.supports('font-weight', 'var(--tmp-var)'));\n    (_b = (_a = styleElement.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild) === null || _b === void 0 ? void 0 : _b.call(_a, styleElement);\n    return isSupported;\n}\nfunction supportsCssGrid() {\n    var el = document.createElement('div');\n    return typeof el.style.grid === 'string';\n}\nfunction supportsES2017() {\n    try {\n        /* eslint-disable no-new-func */\n        // ES6 features\n        new Function('let x = 1');\n        new Function('const x = `1`');\n        new Function('class X {}');\n        new Function('const x = (a = 0, ...b) => a');\n        new Function('const x = {...Object}');\n        new Function('const y = 1; const x = {y}');\n        new Function('const x = (function*() { yield 1; })().next().value === 1');\n        // ES2017 features\n        new Function('const x = async () => await new Promise(res => res(true))');\n        new Function('const objWithTrailingComma = {a: 1, b: 2,}');\n        new Function('const arrWithTrailingComma = [1,2,3,]');\n        Object.entries({});\n        Object.values({});\n        'x'.padStart(3, 'A').padEnd(5, 'B');\n        Object.getOwnPropertyDescriptor({ a: 1, b: 2 }, 'a');\n        // Starting from Chrome 61 we don't load polyfills (nomodule support), but Object.fromEntries was added only in Chrome 73\n        Object.fromEntries([['a', 1]]);\n        /* eslint-enable no-new-func */\n    }\n    catch (e) {\n        return false;\n    }\n    return true;\n}\n//# sourceMappingURL=browser-deprecation.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.reportPhaseStarted = void 0;\nvar _window = window;\nfunction uuidv4() {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n        var r = (Math.random() * 16) | 0, v = c === 'x' ? r : (r & 0x3) | 0x8;\n        return v.toString(16);\n    });\n}\nfunction sendBI(evid, extra) {\n    if (extra === void 0) { extra = ''; }\n    var _a = _window.fedops.data, site = _a.site, rollout = _a.rollout, fleetConfig = _a.fleetConfig, requestUrl = _a.requestUrl, frogOnUserDomain = _a.frogOnUserDomain;\n    if (requestUrl.includes('suppressbi=true')) {\n        return;\n    }\n    var fedOpsAppName = site.appNameForBiEvents;\n    var isDACRollout = rollout.isDACRollout, siteAssetsVersionsRollout = rollout.siteAssetsVersionsRollout;\n    var is_dac_rollout = isDACRollout ? 1 : 0;\n    var is_sav_rollout = siteAssetsVersionsRollout ? 1 : 0;\n    var is_rollout = fleetConfig.code === 0 || fleetConfig.code === 1 ? fleetConfig.code : null;\n    var pageVisibilty = document.visibilityState;\n    var types = {\n        WixSite: 1,\n        UGC: 2,\n        Template: 3,\n    };\n    var siteType = site.siteType;\n    var st = types[siteType] || 0;\n    var frog = frogOnUserDomain ? site.externalBaseUrl.replace(/^https?:\\/\\//, '') + '/_frog' : '//frog.wix.com';\n    var url = frog +\n        '/' +\n        'bolt-performance?src=72&evid=' +\n        evid +\n        '&appName=' +\n        fedOpsAppName +\n        '&is_rollout=' +\n        is_rollout +\n        '&is_sav_rollout=' +\n        is_sav_rollout +\n        '&is_dac_rollout=' +\n        is_dac_rollout +\n        '&dc=' +\n        site.dc +\n        '&msid=' +\n        site.metaSiteId +\n        '&session_id=' +\n        site.sessionId +\n        '&vsi=' +\n        uuidv4() +\n        '&pv=' +\n        pageVisibilty +\n        '&v=' +\n        _window.thunderboltVersion +\n        '&url=' +\n        requestUrl +\n        '&st=' +\n        st +\n        extra;\n    // send beacon the old way:\n    new Image().src = url;\n}\nfunction reportPhaseStarted(phase, extra) {\n    var evid = 28;\n    var ts = Date.now() - _window.initialTimestamps.initialTimestamp;\n    var duration = Date.now() - ts;\n    sendBI(evid, \"&name=\".concat(phase, \"&duration=\").concat(duration).concat(extra ? '&' + extra : ''));\n}\nexports.reportPhaseStarted = reportPhaseStarted;\n//# sourceMappingURL=reportPhaseStarted.js.map"],"names":["_a","_b","_c","_d","Object","defineProperty","exports","value","head","style","reportPhaseStarted_1","_window","window","userAgent","navigator","toLowerCase","call","isIEbyDocumentMode","document","documentMode","isIEByUA","match","isIE","requiredBrowserNativeApis","isOldBrowser","supportsCssVars","supportsCssGrid","supportsES2017","every","api","isSafari14","test","isWixStudio","viewerModel","site","editorName","isSafari14InStudio","runDeprecationFlow","siteContainer","iframe","iframeUrl","getElementById","innerHTML","createElement","userLanguage","language","concat","pt","fr","es","de","ja","getIframeUrlForOldBrowserMessage","setAttribute","onload","body","visibility","appendChild","supportedFeatures","customElements","IntersectionObserver","ResizeObserver","e","console","error","reportPhaseStarted","JSON","stringify","reportBI","styleElement","isSupported","CSS","supports","parentNode","removeChild","grid","Function","entries","values","padStart","padEnd","getOwnPropertyDescriptor","a","b","fromEntries","__browser_deprecation__","getElementsByTagName","createTextNode","Sentry","mute","readyState","addEventListener","sendBI","evid","extra","fedops","data","rollout","fleetConfig","requestUrl","frogOnUserDomain","includes","fedOpsAppName","appNameForBiEvents","is_dac_rollout","isDACRollout","is_sav_rollout","siteAssetsVersionsRollout","is_rollout","code","pageVisibilty","visibilityState","st","WixSite","UGC","Template","siteType","url","externalBaseUrl","replace","frog","dc","metaSiteId","sessionId","c","r","Math","random","toString","thunderboltVersion","Image","src","phase","ts","Date","now","initialTimestamps","initialTimestamp","duration"],"sourceRoot":""}